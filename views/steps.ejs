<!doctype html>
<html lang="en-us">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Biotree</title>
    <meta name="description" content="Dashboard UI Kit">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-signin-client_id" content="347643143038-1poc0bhn688aug03hpjlq89r6c6o1bau.apps.googleusercontent.com">
    <link rel="stylesheet" href="https://use.typekit.net/foj0sle.css">
    <link rel="stylesheet" href="/userui/bootstrap/bootstrap.min.css">
    <link rel="shortcut icon" href="/userui/64.png" type="image/x-icon">

    <!-- Stylesheet -->
    <link rel="stylesheet" href="/userui/css/main.css">
    <link rel="stylesheet" href="/userui/css/steps.css">
    <link rel="stylesheet" href="/userui/css/colors.css">

    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="/userui/js/bootstrap/bootstrap.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://apis.google.com/js/platform.js?onload=init" async defer></script>

    <!-- Stylesheet -->
    <!-- <script src="js/app.js"></script> -->


    <style>
        @import url("https://use.typekit.net/foj0sle.css");
        /* .gmd-4 {
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.05);

} */
    </style>





</head>

<body>
    <header class="c-navbar">


        <a class="c-navbar__brand">
            <img src="/userui/biotree_logo.png" alt="Dashboard's Logo">
        </a>
        <!-- Navigation items that will be collapes and toggle in small viewports -->
        <nav class="c-nav collapse" id="main-nav">
            <ul class="c-nav__list">
                <!-- <li class="c-nav__item">
                    <a class="c-nav__link" href="#!">Client Name</a>
                </li> -->

                <li class="c-nav__item">

                </li>
            </ul>
        </nav>
        <!-- // Navigation items  -->

        <div class="c-dropdown u-ml-auto dropdown">
            <a class="c-avatar c-avatar--xsmall has-dropdown dropdown-toggle" href="#" id="dropdwonMenuAvatar" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <!-- <img class="c-avatar__img" src="./64.png" alt="User's Profile Picture"> -->
                <i class="fa fa-user" aria-hidden="true" style="font-size:25px;color:grey"></i>

            </a>

            <div class="c-dropdown__menu dropdown-menu dropdown-menu-right" aria-labelledby="dropdwonMenuAvatar">
                <a class="c-dropdown__item dropdown-item" href="/logout" onclick="signOut();">Sign out</a>


                <!-- <a class="c-dropdown__item dropdown-item" onclick="signOut();">LogOut</a> -->

                <!-- <a class="c-dropdown__item dropdown-item" href="#">Manage Roles</a> -->
            </div>
        </div>

        <button class="c-nav-toggle" type="button" data-toggle="collapse" data-target="#main-nav">
            <span class="c-nav-toggle__bar"></span>
            <span class="c-nav-toggle__bar"></span>
            <span class="c-nav-toggle__bar"></span>
        </button>
        <!-- // .c-nav-toggle -->
    </header>

    <body>
        <div class="g-signin2" data-onsuccess="onSignIn" style="width: 1px;opacity: 0;"> </div>

        <!-- ###################################################################################################### -->
        <!-- multistep form -->
        <form id="msform">
            <!-- progressbar -->
            <ul id="progressbar">
                <li class="active" style="color:black;font-size: 13px">Step-1</li>
                <li style="color:black;font-size: 13px">Step-2</li>
                <li style="color:black;font-size: 13px">Step-3</li>
            </ul>
            <!-- fieldsets -->
            <fieldset>
                <h2 class="fs-subtitle">Welcome to Biotree</h2>
                <h4 class="fs-title u-mt-small" style="text-transform:capitalize;margin-bottom: 20px">Add multiple links to your Social Media Bio </h4>

                <img src="/userui/img/billing.jpg" class="u-mb-small">


                <!-- <input type="text" name="email" placeholder="Email" />
            <input type="password" name="pass" placeholder="Password" />
            <input type="password" name="cpass" placeholder="Confirm Password" /> -->
                <input type="button" name="next" class="next action-button" value="Next" />
            </fieldset>
            <fieldset>
                <!-- <h2 class="fs-title">Social Profiles</h2> -->
                <!-- <h2 class="fs-subtitle">This is step 2</h2> -->

                <h4 class="fs-title u-mt-small" style="text-transform:capitalize;margin-bottom: 20px">Take users to your Links/Direct Messages
                </h4>
                <img src="/userui/img/billing.jpg" class="u-mb-small">

                <!-- <input type="text" name="twitter" placeholder="Twitter" />
            <input type="text" name="facebook" placeholder="Facebook" />
            <input type="text" name="gplus" placeholder="Google Plus" /> -->
                <input type="button" name="previous" class="previous action-button" value="Previous" />
                <input type="button" name="next" class="next action-button" value="Next" />
            </fieldset>
            <fieldset>
                <!-- <h2 class="fs-subtitle">This is step 3</h2> -->

                <h4 class="fs-title u-mt-small" style="text-transform:capitalize;margin-bottom: 20px">Track with Retargeting - Without coding know-how </h4>
                <img src="/userui/img/billing.jpg" class="u-mb-small">

                <!-- <input type="text" name="fname" placeholder="First Name" />
            <input type="text" name="lname" placeholder="Last Name" />
            <input type="text" name="phone" placeholder="Phone" />
            <textarea name="address" placeholder="Address"></textarea> -->
                <input type="button" name="previous" class="previous action-button" value="Previous" />

                <input type="submit" name="submit" class="submit action-button gotodashboard" value="Submit" />
                <!-- data-toggle="modal" data-target="#modal7" -->
            </fieldset>
        </form>
        <!-- /////////////////////////////////////////////////////////// -->
        <div class="c-modal c-modal--xsmall modal fade model" id="modal7" tabindex="-1" role="dialog" aria-labelledby="modal7" data-backdrop="static">
            <div class="c-modal__dialog modal-dialog " role="document" style="max-width:590px;">
                <div class="c-modal__content">
                    <div class="c-modal__header" style="background: linear-gradient(135deg, #3f53a9 0%, #6b4193 100%);">
                        <h3 class="c-modal__title">Add New Client</h3>
                        <span class="c-modal__close" data-dismiss="modal" aria-label="Close">
							<i class="fa fa-close" style="color:#fff"></i>
						</span>
                    </div>
                    <div class="c-modal__body" style="height:500px;overflow: scroll">
                        <div class="c-field u-mb-xsmall d1d">
                            <label class="c-field__label " for="select12">Client Name</label>
                            <input id="clientname" class="c-input q0d" type="text">
                            <span class="alert-danger disit" style="display:none">please Enter the URL here</span>
                        </div>

                        <div class="c-field u-mb-medium">
                            <div class="row">
                                <div class="col-sm-6 ">
                                    <label class="c-field__label" for="select12" style="padding-top:9px">Tracking
										pixels</label>
                                </div>
                                <div class="col-sm-6 text-right">
                                    <div class="c-dropdown dropdown">
                                        <button class="c-btn outline has-add dropdown-toggle c-btn-block dropit " id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="text-align:right">Add
											New</button>
                                        <div class="c-dropdown__menu dropdown-menu dropdown-menu-right c-dropdown__menu--large-custom add-full-track" style="height:300px;overflow: scroll;margin-top:100px;" aria-labelledby="dropdownMenuButton" id="dropdown">
                                            <!-- style="height:480px;overflow: scroll;margin-top: 100px;" -->

                                            <% for(let i=0; i < trackingList.length; i++) { %>

                                                <a class="c-dropdown__item dropdown-item form-check form-check-inline add-track-indi" href="#" style="padding:4px 0 0 5px;" data-name="<%=trackingList[i].prefixname%>" data-icon="<%=trackingList[i].icon%>" data-id="<%=trackingList[i]._id%>">
                                                    <label class="iconbox1">
													<i class="<%=trackingList[i].icon%>" id="dropdownicon"></i>
												</label>

                                                    <label class="form-check-label mx-auto" for="inlineCheckbox1" style="margin-left:8px;font-size:14px;font-weight: 100;position: relative;color:black">
													<%=trackingList[i].name%></label>

                                                </a>
                                                <% } %>
                                        </div>
                                    </div>
                                    <!-- #####################################################dropdown end -->
                                </div>

                            </div>
                            <div class="bron">
                                <ul id="add-track-data">

                                </ul>

                            </div>

                            <!-- #######################################################end popover -->
                        </div>
                        <!-- <a class="c-btn c-btn--success c-btn--fullwidth newproject1 c-modal__close" href="#" style="background: linear-gradient(135deg, #3f53a9 0%, #6b4193 100%);color:#fff;">
							Continue
						</a> -->
                        <button type="button" id="add_client" class="c-btn c-btn--fullwidth c-modal__close" style="background: linear-gradient(135deg, #3f53a9 0%, #6b4193 100%);color:#fff;border:1px solid purple">Save
						</button>
                        <!-- <div id="delete"></div> -->
                    </div>
                </div>
                <!-- // .c-modal__content -->
            </div>
            <!-- // .c-modal__dialog -->
        </div>






















    </body>
    <!-- ###################################################################################################### -->




    <script src="/userui/js/main.js"></script>

    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script>
        function onLoad() {
            gapi.load('auth2', function() {
                gapi.auth2.init();
            });
        }

        function signOut() {

            // let auth2 = gapi.auth2.getAuthInstance();
            // auth2.signOut().then(function() {
            //     console.log('User signed out.');
            // });

            // let auth2 = gapi.auth2.getAuthInstance();
            // auth2.signOut().then(function() {});
            // auth2.disconnect();

            let auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function() {});
            auth2.disconnect();
            window.location.href = "/login";

        }



        // gapi.auth2.init().then(() => { /* signout stuff here */ })
    </script>
    <script type="text/javascript">
        $(function() {


            //jQuery time
            let current_fs, next_fs, previous_fs; //fieldsets
            let left, opacity, scale; //fieldset properties which we will animate
            let animating; //flag to prevent quick multi-click glitches

            $(".next").click(function() {
                if (animating) return false;
                animating = true;

                current_fs = $(this).parent();
                next_fs = $(this).parent().next();

                //activate next step on progressbar using the index of next_fs
                $("#progressbar li").eq($("fieldset").index(next_fs)).addClass("active");

                //show the next fieldset
                next_fs.show();
                //hide the current fieldset with style
                current_fs.animate({
                    opacity: 0
                }, {
                    step: function(now, mx) {
                        //as the opacity of current_fs reduces to 0 - stored in "now"
                        //1. scale current_fs down to 80%
                        scale = 1 - (1 - now) * 0.2;
                        //2. bring next_fs from the right(50%)
                        left = (now * 50) + "%";
                        //3. increase opacity of next_fs to 1 as it moves in
                        opacity = 1 - now;
                        current_fs.css({
                            'transform': 'scale(' + scale + ')',
                            'position': 'absolute'
                        });
                        next_fs.css({
                            'left': left,
                            'opacity': opacity
                        });
                    },
                    duration: 800,
                    complete: function() {
                        current_fs.hide();
                        animating = false;
                    },
                    //this comes from the custom easing plugin
                    easing: 'easeInOutBack'
                });
            });

            $(".previous").click(function() {
                if (animating) return false;
                animating = true;

                current_fs = $(this).parent();
                previous_fs = $(this).parent().prev();

                //de-activate current step on progressbar
                $("#progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");

                //show the previous fieldset
                previous_fs.show();
                //hide the current fieldset with style
                current_fs.animate({
                    opacity: 0
                }, {
                    step: function(now, mx) {
                        //as the opacity of current_fs reduces to 0 - stored in "now"
                        //1. scale previous_fs from 80% to 100%
                        scale = 0.8 + (1 - now) * 0.2;
                        //2. take current_fs to the right(50%) - from 0%
                        left = ((1 - now) * 50) + "%";
                        //3. increase opacity of previous_fs to 1 as it moves in
                        opacity = 1 - now;
                        current_fs.css({
                            'left': left
                        });
                        previous_fs.css({
                            'transform': 'scale(' + scale + ')',
                            'opacity': opacity
                        });
                    },
                    duration: 800,
                    complete: function() {
                        current_fs.hide();
                        animating = false;
                    },
                    //this comes from the custom easing plugin
                    easing: 'easeInOutBack'
                });
            });

            $(".submit").click(function() {
                return false;
            });
            // //////////////////////////
            $(".gotodashboard").click(function() {
                // window.location.href = "/dashboard";
                $('#modal7').modal('show');

            });


            let data = <%- JSON.stringify(trackingList) %>;
            console.log(data);




            function updateClient(clientName, clientId, trackingList) {
                // Bind Date To the Popup View

                let count = JSON.parse(trackingList).length;
                if (count > 0) {

                }

            }

            function updateShortURL(id, shortcode, website, source, name, term, medium, content) {
                $('#modal10').modal('show');
                console.log(id);
                console.log(shortcode);
                console.log(website);
                console.log(source);
                console.log(term);
                console.log(name);
                console.log(medium);
                console.log(content);

            }


            // console.log(clientCount);

            // declare it
            // if (clientCount == 0) // Show Add Client Popup if there are no Clients
            // {
            //     $('#modal7').modal('show');
            // }

            $('.add-full-track').on('click', '.add-track-indi', function() {


                let prefixname = $(this).data("name");
                let icon = $(this).data("icon");
                let id = $(this).data("id");
                console.log(name);
                console.log(icon);
                console.log(id);
                let listItemToAdda = makelist1(icon, id, prefixname);
                $("#add-track-data").append(listItemToAdda);




            });

            function makelist1(img, id, name) {
                let $allData = `<div class="sortableitem u-mt-custom" ><li>
<div class="row justify-content-left nolo r0">
<div class="col-md-10 col-9 r2" >
<div class="c-field has-addon-left">
<span class="id" style="display:none">` + id + `</span>
<span class="img" style="display:none">` + img + `</span>
<span class="c-field__addon"><i class="` + img + `" style="font-size:22px;color:#fff"></i></span>
<input class="c-input ip"  id="input1" type="text" placeholder="Enter Your tracking pixels id">
<span class="name" style="display:none">` + name + `</span>

</div>
</div>
<div class="col-md-1 col-1 text-center r4 " style="padding-top:8px;">
<div class="pull-right">
<i class="fa fa-question" aria-hidden="true" style="font-size:15px;"></i>
</div>
</div>
<div class="col-md-1 col-1 r3">
<div class="pull-right">
<a class="btn deli"> <i class="fa fa-trash-o" aria-hidden="true"></i></a>
</div>
</div>
</li></div>`;
                return $allData;

            }







            // FIXME ADD CLIENT
            $('#add_client').on("click", function() {

                let clientname = false;
                let socialdata = false;
                let getcleintname = $('.q0d').val();
                console.log(getcleintname);
                if (!getcleintname) {
                    alert("please enter Your Name");
                    clientname = true;

                    console.log("empty");
                } else {
                    // console.log("its there");
                }
                let $socialdata = $('#add-track-data').children().length;


                let $appendData22 = $('#add-track-data').children();
                for (let index = 0; index < $appendData22.length; index++) {
                    let $dynamic = $appendData22.eq(index);
                    let trackingid = $dynamic.children().find('.id').html();
                    let href = $dynamic.children().find('.ip').val();
                    let img = $dynamic.children().find('.img').html();
                    let name = $dynamic.children().find('.name').html();

                    if (href === '') {
                        $dynamic.children().eq(0).find('.disit').remove();
                        $dynamic.children().eq(0).append('<span class="alert-danger disit">please Enter the URL here</span>');
                        console.log("social empty");
                        socialdata = true;

                    } else {
                        // $dynamic.children().eq(0).remove('.disit');
                        $dynamic.children().eq(0).find('.disit').remove();
                        console.log("socialthere");


                    }


                }
                console.log(clientname);
                console.log(socialdata);
                if (clientname == false && socialdata == false) {
                    addclientdata();
                }

                // ///////////////////////////////////////////////////sending data as object





            });

            function addclientdata() {
                let clientobj = {

                    'trackingList': []
                };
                let clientName = $('.q0d').val();
                console.log(clientName);
                clientobj.name = clientName;

                let $appendData1 = $('#add-track-data').children()
                for (let index = 0; index < $appendData1.length; index++) {
                    let $dynamic = $appendData1.eq(index);
                    console.log($dynamic);
                    let trackingid = $dynamic.children().find('.id').html();
                    let href = $dynamic.children().find('.ip').val();
                    let img = $dynamic.children().find('.img').html();
                    let name = $dynamic.children().find('.name').html();

                    let k = {}
                    k.id = trackingid;
                    k.tracking_code = href;
                    k.icon = img;
                    k.name = name;


                    clientobj.trackingList.push(k)




                }
                console.log(clientobj);
                $.ajax({
                    type: 'POST',
                    data: clientobj,
                    url: '/create-client',
                    success: function(data) {

                        $('#modal7').modal('hide');
                        let message = data.data;
                        swal(
                            'Great!',
                            message,
                            'success'
                        );
                        window.location.href = "/dashboard";
                    },
                    error: function(XMLHttpRequest, textStatus, errorThrown) {
                        alert(textStatus + errorThrown);
                    }

                });



            }
            $('#add-track-data').on("click", ".deli", function() {

                let bolo = $(this).parentsUntil('.sortableitem').parent().remove();

            });


            // $('.dynamic').on("click", '.get-updated-data', function() {








        });
    </script>

</body>

</html>